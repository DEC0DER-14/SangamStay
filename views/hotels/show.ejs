<% layout('layouts/boilerplate') %>

<style>
    .hotel-details-container {
        background-color: #f8f9fa;
        min-height: 100vh;
        padding: 1rem 0;
    }
    
    .hotel-header {
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        padding: 3rem 1rem;
        margin-bottom: 2rem;
        border-radius: 0 0 15px 15px;
        color: white;
        text-align: center;
    }
    
    .hotel-name {
        font-size: 2rem;
        font-weight: 600;
        margin-bottom: 0.8rem;
    }
    
    .hotel-location {
        font-size: 1.1rem;
        opacity: 0.9;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        justify-content: center;
    }
    
    .content-card {
        background: white;
        border-radius: 20px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    
    .price-tag {
        background: #2c3e50;
        color: white;
        padding: 0.8rem 1.5rem;
        border-radius: 25px;
        font-size: 1.3rem;
        font-weight: 600;
        display: inline-block;
        margin-bottom: 1.2rem;
    }
    
    .amenities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.8rem;
        margin: 1.2rem 0;
    }
    
    .amenity-item {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.6rem;
        background: #f8f9fa;
        border-radius: 8px;
        font-size: 0.9rem;
        color: #2c3e50;
    }

    .facilities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 1rem;
        margin: 1.2rem 0;
    }
    
    .facility-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.8rem;
        background: #f8f9fa;
        border-radius: 10px;
        font-size: 1rem;
        color: #2c3e50;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .facility-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    }

    .facility-item i {
        font-size: 1.1rem;
        color: #3498db;
    }
    
    .room-card {
        border: 1px solid #eee;
        border-radius: 10px;
        padding: 1.2rem;
        margin-bottom: 1rem;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .room-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .review-card {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 1.2rem;
        margin-bottom: 1rem;
    }
    
    .review-header {
        display: flex;
        align-items: center;
        gap: 0.8rem;
        margin-bottom: 0.8rem;
    }
    
    .review-avatar {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        background: #2c3e50;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 0.9rem;
    }
    
    .btn-book-now {
        background: #2c3e50;
        color: white;
        padding: 0.8rem 2rem;
        border-radius: 25px;
        font-size: 1rem;
        transition: all 0.3s ease;
        border: none;
        width: 100%;
    }
    
    .btn-book-now:hover {
        background: #34495e;
        color: white;
        transform: translateY(-2px);
    }
    
    .admin-actions {
        position: absolute;
        top: 1rem;
        right: 1rem;
        z-index: 10;
    }

    .rooms-available {
        font-size: 2rem;
        font-weight: 600;
        color: #27ae60;
    }

    @media (max-width: 768px) {
        .hotel-name {
            font-size: 1.5rem;
        }
        
        .hotel-location {
            font-size: 1rem;
        }
        
        .price-tag {
            font-size: 1.1rem;
            padding: 0.6rem 1.2rem;
        }
        
        .content-card {
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .amenities-grid {
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.6rem;
        }
        
        .room-card {
            padding: 1rem;
        }
        
        .review-card {
            padding: 1rem;
        }
        
        .container {
            padding-left: 1rem;
            padding-right: 1rem;
        }
    }

    @media (max-width: 576px) {
        .hotel-header {
            padding: 2rem 1rem;
        }
        
        .hotel-name {
            font-size: 1.3rem;
        }
        
        .hotel-location {
            font-size: 0.9rem;
        }
        
        .amenities-grid {
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
        }
        
        .amenity-item {
            font-size: 0.8rem;
            padding: 0.5rem;
        }
        
        .btn-book-now {
            padding: 0.7rem 1.5rem;
            font-size: 0.9rem;
        }
        
        .rooms-available {
            font-size: 1.5rem;
        }
    }

    .modal-content {
        border-radius: 12px;
    }

    .modal-header {
        padding: 1rem 1.5rem;
        border-bottom: 1px solid #eee;
    }

    .modal-body {
        padding: 1.5rem;
    }

    .modal-footer {
        padding: 1rem 1.5rem;
        border-top: 1px solid #eee;
    }

    @media (max-width: 576px) {
        .modal-content {
            margin: 1rem;
        }
        
        .modal-header, .modal-body, .modal-footer {
            padding: 1rem;
        }
    }

    .price-summary {
        border-top: 1px solid #eee;
        padding-top: 1.5rem;
    }

    .price-badge {
        background: #f8f9fa;
        padding: 0.8rem 1.2rem;
        border-radius: 8px;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        transition: transform 0.2s ease;
    }

    .price-badge:hover {
        transform: translateY(-2px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .price-badge .room-type {
        color: #2c3e50;
        font-weight: 500;
    }

    .price-badge .price {
        color: #2ecc71;
        font-weight: 600;
        font-size: 1.1rem;
    }

    .price-badge small {
        font-size: 0.8rem;
    }
</style>

<div class="hotel-details-container">
    <!-- Hotel Header -->
    <div class="hotel-header text-center">
        <div class="container">
            <h1 class="hotel-name"><%= hotel.name %></h1>
            <p class="hotel-location">
                <i class="fas fa-map-marker-alt"></i>
                <%= hotel.location %>
                <span class="ms-2 badge bg-light text-dark">
                    <i class="fas fa-map-pin me-1"></i><%= hotel.pincode %>
                </span>
            </p>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <!-- Main Details -->
                <div class="content-card">
                    <div class="price-tag">
                        <i class="fas fa-tag me-2"></i>₹<%= hotel.price %> per night
                    </div>
                    
                    <% if(hotel.description) { %>
                        <h4>About the Hotel</h4>
                        <p class="lead"><%= hotel.description %></p>
                    <% } %>

                    <% if(hotel.rooms && hotel.rooms.length > 0) { %>
                        <div class="price-summary mt-4">
                            <h5 class="mb-3">Room Pricing</h5>
                            <div class="d-flex flex-wrap gap-3">
                                <% hotel.rooms.forEach(room => { %>
                                    <div class="price-badge">
                                        <span class="room-type"><%= room.roomType %></span>
                                        <span class="price">₹<%= room.pricePerNight %></span>
                                        <small class="text-muted">/night</small>
                                    </div>
                                <% }) %>
                            </div>
                        </div>
                    <% } %>
                </div>

                <!-- Facilities Section -->
                <div class="content-card">
                    <h4 class="mb-3">Facilities</h4>
                    <div class="facilities-grid">
                        <% if(hotel.facilities && hotel.facilities.length > 0) { %>
                            <% hotel.facilities.forEach(facility => { %>
                                <div class="facility-item">
                                    <i class="fas <%= 
                                        facility.includes('AC') ? 'fa-snowflake' : 
                                        facility.includes('WiFi') ? 'fa-wifi' :
                                        facility.includes('Parking') ? 'fa-parking' :
                                        facility.includes('Elevator') ? 'fa-elevator' :
                                        facility.includes('Food') ? 'fa-utensils' : 'fa-check'
                                    %>"></i>
                                    <span><%= facility %></span>
                                </div>
                            <% }) %>
                            <% if (hotel.facilities.includes('Food Services (Chargeable)')) { %>
                                <div class="facility-item">
                                    <i class="fas fa-utensils facility-icon"></i>
                                    <span>Food Services</span>
                                </div>
                            <% } %>
                            <% if (hotel.facilities.includes('Daily House Keeping')) { %>
                                <div class="facility-item">
                                    <i class="fas fa-broom facility-icon"></i>
                                    <span>House Keeping</span>
                                </div>
                            <% } %>
                        <% } else { %>
                            <p class="text-muted">No facilities listed for this hotel.</p>
                        <% } %>
                    </div>
                </div>

                <!-- Room Types -->
                <% if(hotel.rooms && hotel.rooms.length > 0) { %>
                    <div class="content-card">
                        <h4 class="mb-4">Available Room Types</h4>
                        <% hotel.rooms.forEach(room => { %>
                            <div class="room-card">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h5 class="mb-2"><%= room.roomType %></h5>
                                        <p class="mb-2">
                                            <i class="fas fa-user-friends me-2"></i>
                                            Capacity: <%= room.capacity %> persons
                                        </p>
                                    </div>
                                    <div class="text-end">
                                        <h5 class="mb-2">₹<%= room.pricePerNight %></h5>
                                        <small class="text-muted">per night</small>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                    </div>
                <% } %>

                <!-- Reviews Section -->
                <% if(hotel.reviews && hotel.reviews.length > 0) { %>
                    <div class="content-card">
                        <h4 class="mb-4">Guest Reviews</h4>
                        <% for(let review of hotel.reviews) { %>
                            <div class="review-card">
                                <div class="review-header">
                                    <div class="review-avatar">
                                        <%= review.author ? review.author.username.charAt(0).toUpperCase() : 'A' %>
                                    </div>
                                    <div>
                                        <h6 class="mb-0"><%= review.author ? review.author.username : 'Anonymous' %></h6>
                                        <small class="text-muted">
                                            <%= new Date(review.createdAt).toLocaleDateString() %>
                                        </small>
                                    </div>
                                </div>
                                <p class="mb-0"><%= review.body %></p>
                            </div>
                        <% } %>
                    </div>
                <% } %>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <div class="content-card">
                    <div class="text-center mb-4">
                        <h4>Available Rooms</h4>
                        <div class="rooms-available fs-1 text-success mb-2">
                            <%= hotel.availableRooms %>
                        </div>
                        <p class="text-muted">rooms left</p>
                    </div>

                    <% if(currentUser) { %>
                        <a href="/hotels/<%= hotel._id %>/book" class="btn btn-book-now w-100">
                            Book Now
                        </a>
                    <% } else { %>
                        <a href="/login" class="btn btn-book-now w-100">
                            Login to Book
                        </a>
                    <% } %>
                </div>

                <% if(currentUser && (currentUser.role === 'admin' || (hotel.author && hotel.author._id && hotel.author._id.equals(currentUser._id)))) { %>
                    <div class="content-card">
                        <h4 class="mb-3">Admin Actions</h4>
                        <div class="d-grid gap-2">
                            <a class="btn btn-outline-primary" href="/hotels/<%= hotel._id %>/edit">
                                <i class="fas fa-edit me-2"></i>Edit Hotel
                            </a>
                            <form class="delete-hotel-form" action="/hotels/<%= hotel._id %>?_method=DELETE" method="POST">
                                <button type="button" class="btn btn-outline-danger w-100 delete-hotel-btn" 
                                        data-bs-toggle="modal" data-bs-target="#deleteConfirmationModal">
                                    <i class="fas fa-trash-alt me-2"></i>Delete Hotel
                                </button>
                            </form>
                        </div>
                    </div>
                <% } %>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteConfirmationModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this hotel? This action cannot be undone.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>
</div> 